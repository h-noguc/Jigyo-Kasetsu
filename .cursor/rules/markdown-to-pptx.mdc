---
description: MarkdownファイルをPowerPointスライド（.pptx）に変換するスキル。LLMが生成したMarkdownを編集可能なPPTXに変換します。
globs:
  - "**/*.md"
alwaysApply: false
---

# Markdown→PowerPoint変換スキル

このスキルを使用して、MarkdownファイルをPowerPointスライド（.pptx）に変換できます。

## 使用方法

### 変換コマンド

```bash
python3 .Skills/markdown_to_pptx/simple_markdown_to_pptx.py <入力ファイル.md> [出力ファイル.pptx]
```

出力ファイル名を省略すると、入力ファイル名から自動生成されます（例: `input.md` → `input.pptx`）。

### 事前準備

変換に必要なライブラリをインストール:

```bash
pip install python-pptx
```

## スライドの分割ルール（重要）

パーサーはMarkdownを `---` で分割した後、各ブロックの**ディレクティブ（HTMLコメント）**の有無によってスライドの割り当てを決定する。ディレクティブは3種類。

| ディレクティブ | 効果 |
|---|---|
| なし | 通常スライド。1ブロック＝1スライド |
| `<!-- _class: title -->` | タイトルスライド（中央揃え）。1ブロック＝1スライド |
| `<!-- _single_page -->` / `<!-- _no_split -->` | **そのブロック以降、次にディレクティブが出現するブロックまでの全ブロックを1枚のスライドに結合する**。フォントサイズが自動縮小される |

### `_single_page` の結合ルール（最重要）

`_single_page`（または `_no_split`）を付けたブロックは、**後続のブロックを貪欲に吸収する**。吸収が止まる条件は以下のいずれか:

1. 次のブロックに `_single_page` / `_no_split` がある → そこで止まる（次のブロックは新しい single_page スライドになる）
2. 次のブロックに `_class: title` がある → そこで止まる（次のブロックはタイトルスライドになる）
3. ブロックがなくなる（ファイル末尾）

**ディレクティブなしの通常ブロックは吸収される。** つまり、`_single_page` の直後に通常ブロックを置くと、そのブロックは独立したスライドにならず前のスライドに結合される。

### 正しい使い方

```markdown
<!-- _single_page -->

## 情報量の多いスライドA

（大量のコンテンツ）

---

<!-- _single_page -->

## 情報量の多いスライドB

（大量のコンテンツ）

---

<!-- _class: title -->

# 次のセクション（タイトルスライド）

---

## 通常のスライド

（通常のコンテンツ。ここからはディレクティブなしでOK）
```

### よくある間違い

```markdown
<!-- _single_page -->

## 情報量の多いスライド

（大量のコンテンツ）

---

## 通常のスライド ← ⚠️ ディレクティブなし。前のスライドに吸収される！

---

## これも吸収される ← ⚠️ 同上
```

### 安全な設計パターン

- **`_single_page` は連続して使う** — 複数の `_single_page` スライドが連続する場合、各ブロックにディレクティブがあるので互いに独立する
- **`_single_page` の後には必ずディレクティブ付きブロックを置く** — `_class: title` または次の `_single_page` で止める
- **迷ったら `_single_page` を使わない** — 1ブロックの内容量を減らして通常スライドに収める方が安全

## Markdown記法ガイド

### スライドの区切り

`---`（ハイフン3つ、前後に空行）でスライドを区切る:

```markdown
# スライド1のタイトル

内容...

---

# スライド2のタイトル

内容...
```

### タイトルスライド

以下のいずれかでタイトルスライド（中央揃え）になる:

1. **スライドの先頭がH1（`#`）** — 自動判定される
2. **`<!-- _class: title -->` を明示的に記述** — H1以外で始まるスライドをタイトルにしたい場合

```markdown
<!-- _class: title -->

# タイトル

サブタイトル
```

> **注意**: H1で始まるスライドは常にタイトルスライドになる。H1をタイトルスライド以外で使いたい場合はH2に下げること。

### 見出しレベル

```markdown
# H1見出し（大きなタイトル: 23pt）→ タイトルスライド専用
## H2見出し（セクションタイトル: 21pt）→ 通常スライドの見出し
### H3見出し（サブセクション: 19pt）
```

### リスト

```markdown
- 箇条書き項目1
- 箇条書き項目2
- 箇条書き項目3

1. 番号付き項目1
2. 番号付き項目2
3. 番号付き項目3
```

### テーブル

```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| データ1 | データ2 | データ3 |
| データ4 | データ5 | データ6 |
```

### 引用

```markdown
> これは引用文です。
> 複数行にわたる引用も可能です。
```

### 強調

```markdown
**太字**テキスト
*イタリック*テキスト
```

## スタイル設定

現在のデザイン:
- 背景色: 白 (#FFFFFF)
- テキスト色: ダークグレー (#2d2d2d)
- 見出し色: ダークグレー (#2d2d2d)
- フォント: TT Commons Pro（フォールバック: Arial）
- スライドサイズ: 16:9（10インチ × 5.625インチ）

スタイルを変更する場合は `.Skills/markdown_to_pptx/simple_markdown_to_pptx.py` の `STYLE` 辞書を編集してください。

## Markdown生成の手順

1. **スライド構成を決める** — 各スライドのタイトルと内容を箇条書きで設計する
2. **ディレクティブを割り当てる** — タイトルスライドには `_class: title`、情報量の多いスライドには `_single_page` を割り当てる。**`_single_page` の直後に通常スライドが来ないことを確認する**
3. **Markdownを書く** — `---` で区切りながら各スライドの内容を記述する
4. **変換・確認** — PPTXに変換してスライド数が想定通りか確認する。想定と異なる場合は `_single_page` の結合ルールを疑う

## プレゼンテーション生成のテンプレート

```markdown
# プレゼンテーションタイトル

**サブタイトル**

作成者名

---

## アジェンダ

1. トピック1
2. トピック2
3. トピック3

---

## トピック1

### ポイント1

- 箇条書き項目
- 箇条書き項目

---

## トピック2

| 比較項目 | オプションA | オプションB |
|----------|-------------|-------------|
| 価格 | 安い | 高い |
| 品質 | 普通 | 高品質 |

---

## まとめ

> 重要なメッセージをここに記載

---

# ありがとうございました

お問い合わせ先
```

## 注意事項

- コードブロック（` ``` `）はスキップされる
- 画像の挿入は未対応（PPTXで後から追加）
- 複雑なレイアウトはPPTXで後から調整
- 変換後は**スライド数が想定通りか必ず確認**する（`Found N slides` の出力）
- YAMLフロントマター（`---` で囲まれた先頭ブロック）は自動的に除去される
